function initMarketlist(){Array.prototype.map||(Array.prototype.map=function(t,e){var a,o,s;if(null==this)throw new TypeError(" this is null or not defined");var i=Object(this),n=i.length>>>0;if("function"!=typeof t)throw new TypeError(t+" is not a function");for(e&&(a=e),o=new Array(n),s=0;s<n;){var r,d;s in i&&(r=i[s],d=t.call(a,r,s,i),o[s]=d),s++}return o});var t=$.cookie("market_title");void 0===$.cookie("custom")&&"custom"===t?(ajaxLoadMarketlist("USDT"),marketTypeBtn.addClass("btn_selected")):"USDT"===t?(ajaxLoadMarketlist("USDT"),marketTypeBtn.addClass("btn_selected")):"BTC"===t?(ajaxLoadMarketlist("BTC"),$("#btcBtn").addClass("btn_selected")):"ETH"===t?(ajaxLoadMarketlist("ETH"),$("#ethBtn").addClass("btn_selected")):"NEW"===t?(ajaxLoadMarketlist("NEW"),$("#newBtn").addClass("btn_selected")):"custom"===t?($("#customBtn").addClass("btn_selected"),$(".custom-trade-area").show(),ajaxLoadCustom("",3,!1)):(ajaxLoadMarketlist("USDT"),marketTypeBtn.addClass("btn_selected"))}function editCustom(){$(".hide-show-con").toggle(function(){$(".user-select").show(),$(".hide-show-mark").prop("checked",!0)},function(){$(".user-select").hide(),$(".hide-show-mark").prop("checked",!1)})}function customMark(){var t=$.cookie("custom");void 0!==t&&t.split(",").map(function(t,e){var a=$(".normal-trade-area").find("#"+t);a.find(".coin-name").addClass("has-select"),a.find(".user-select").addClass("has-custom")})}function addCoinCookie(t){var e=t.attr("data-id");if(void 0!==$.cookie("custom")){var a=$.cookie("custom").split(",");if(Array.prototype.in_array=function(t){for(i=0;i<this.length&&this[i]!=t;i++);return!(i==this.length)},!a.in_array(e)){var o=[a,e];$.cookie("custom",o,{expires:365,path:"/"})}}else $.cookie("custom",e,{expires:365,path:"/"})}function cutCoinCookie(t){var e=t.attr("data-id"),a=$.cookie("custom").split(",");!function(t,e){for(var a=0;a<t.length;a++)if(t[a]==e){t.splice(a,1);break}}(a,e),0===a.length?$.removeCookie("custom",{path:"/"}):$.cookie("custom",a,{expires:365,path:"/"})}function hideLoading(){$("#marketlist_controller").find("button .load8").hide()}function ajaxLoadMarketlist(t){var e=LocalStorage.get("en_datasingle_"+t,!0);if(0==e.status)return $("#marketlist_box").addClass("uncustom").html(e.data),_onLoadMarketListSuccess(),!0;$("#marketlist_box").load("/datasingle/"+t,function(e,a){"success"==a?(LocalStorage.set("en_datasingle_"+t,e),_onLoadMarketListSuccess()):$(this).html("<div><b class='fail-tip'>Load failed, please try again!</b></div>"),hideLoading()}).addClass("uncustom")}function _onLoadMarketListSuccess(){$("#custom_tbody").html(""),inCustom_btn(),customMark(),oTable=$("#marketlist_box").find(".marketlist").DataTable(tableOption),runChart(),marketTypeBtn.hasClass("from-add")&&$("#normal_tbody").find(".user-select").show(),hideLoading()}function ajaxLoadCustom(t,e,a){function o(){function a(){var e=$("#customlist").find("#"+t+"_plot").parents("tr");e.addClass("new-in").find(".coin-name").addClass("new"),e.find(".user-select").hide(),setTimeout(function(){e.find(".user-select").css("display","")},2e3)}var o=$.cookie("custom");if(void 0!==o&&""!=o){runChart(),1!=e?setTimeout(function(){$(".custom-trade-area").find(".custom-ctrl").show(),$(".hide-show-mark").prop("checked",!1),editCustom()},2e3):$(".user-select").show();var s=$("#customBtn");s.hasClass("active-mark")||setTimeout(function(){customTable=$("#customlist").DataTable(tableOption)},300),s.addClass("active-mark"),s.hasClass("dt-mark")||t&&"undefined"!=typeof initialCo&&""!=o&&setTimeout(function(){customTable.on("draw.dt",function(){$(".user-select").addClass("custom-active").unbind("click"),$(".custom-trade-area").find(".user-select").text("Cancel custom").click(function(){outCustom($(this))})})},300),s.addClass("dt-mark"),$(".fail-tip").html("")}else"undefined"!=typeof customTable&&customTable.clear().draw(),$("#custom_tbody").html(""),$(".custom-trade-area").find(".custom-ctrl").hide(),0!=e&&void 0===$(".lead-to-add").attr("class")&&($(".fail-tip").html("No custom coins!").after("<div class='lead-to-add'><button class='r-btn add-btn'>Add</button></div>"),$(".add-btn").click(function(){marketTypeBtn.addClass("from-add").click(),$("#normal_tbody").find(".user-select").show()}));setTimeout(function(){void 0!==t&&""!=t&&$("html, body").animate({scrollTop:$("#"+t).offset().top-150},10,function(){a()})},200),$(".user-select").addClass("custom-active").unbind("click"),$(".custom-trade-area").find(".user-select").text("Cancel custom").click(function(){outCustom($(this))})}function s(){$(".fail-tip").html("Not all data loaded, please <span id=refresh>refresh</span>!"),$("#refresh").click(function(){location.reload()})}function i(t,e){$.ajax({type:e,url:"/marketdata/"+t,dataType:"html",success:function(e){LocalStorage.set("en_custom_area_"+t,e),$("#custom_tbody").append(e),o()},error:function(){setTimeout(s,200)},complete:function(){hideLoading()}})}$(".normal-trade-area").css("display","none"),$("#custom_box").html('<table class="marketlist dataTable" id=customlist><thead><tr><th class="sorting bizhong"><b>Name</b></th><th class="sorting market-price"><b>Price</b></th><th class="orting"><b>Volume</b></th><th class="sorting"><b>Supply</b></th><th class="sorting"><b>Market Cap</b></th><th class="sorting day-updn"><b>24h Change</b></th><th class="sorting_disabled price-flot"><b>Price Trend(3d)</b></th><th class="sorting_disabled go-trade"></th></tr></thead><tbody id="custom_tbody"></tbody></table>'),["USDT","BTC","ETH","NEW"].forEach(function(t,e){var s=LocalStorage.get("en_custom_area_"+t,!0);a||0!=s.status?i(t,"GET"):($("#custom_tbody").append(s.data),o(),hideLoading())})}function inCustom_btn(){$(".user-select").unbind("click").bind("click",function(){var t=$(this),e=t.attr("data-id");initialCo=$.cookie("custom"),addCoinCookie(t);matchStr.addToStorage("en_datasingle_",e,"en_custom_area_").status;return ajaxLoadCustom(e,0,!0),$(".custom_btn").addClass("btn_selected").siblings().removeClass("btn_selected"),$(".normal-trade-area").hide(),$(".custom-trade-area").show().find(".custom-ctrl").hide(),$("#marketlist_box").addClass("custom-active"),$.cookie("market_title","custom",{expires:365,path:"/"}),$(this).unbind("click"),!0})}function outCustom(t){cutCoinCookie(t),t.parents("tbody").html(""),ajaxLoadCustom("",1,0!=matchStr.removeFromStorage(t.attr("data-id"),"en_custom_area_").status)}function fixedAlertPosition(t){var e=document.body.clientHeight,a=document.body.clientWidth;t.css({left:(a-490)/2,top:(e-490)/2})}$.cookie("nav_index",0,{path:"/"});var oTable;tableOption={bFilter:!0,bInfo:!0,"bLengthChange ":!1,bPaginate:!0,bStateSave:!1,autoWidth:!1,dom:"tf",pageLength:-1,aaSorting:[],aoColumnDefs:[{sType:"string",aTargets:[0]},{sType:"price",sClass:"alignRight",aTargets:[1]},{sType:"volume",sClass:"alignRight",aTargets:[2]},{sType:"totalsupply",sClass:"alignRight",aTargets:[3]},{sType:"volume",sClass:"alignRight",aTargets:[4]},{sType:"percent",sClass:"alignRight",aTargets:[5]},{asSorting:["desc","asc"],aTargets:[1,2,3,4,5]}]},jQuery.extend(jQuery.fn.dataTableExt.oSort,{"totalsupply-pre":function(t){return"<"==t[0]&&(t=$(t).text()),(t=parseFloat(t.substring(0,t.length-4).split(",").join("")))||(t=0),t},"totalsupply-asc":function(t,e){return t-e},"totalsupply-desc":function(t,e){return e-t}}),jQuery.extend(jQuery.fn.dataTableExt.oSort,{"currency-pre":function(t){return(t=parseFloat("-"===t?0:t.replace(/[^\d\-\.]/g,"")))||(t=0),t},"currency-asc":function(t,e){return t-e},"currency-desc":function(t,e){return e-t}}),jQuery.extend(jQuery.fn.dataTableExt.oSort,{"price-pre":function(t){return"?"==t?0:(a0=t,(t=parseFloat("-"===t?0:t.replace(/[^\d\-\.]/g,"")))||(t=0),t)},"price-asc":function(t,e){return t-e},"price-desc":function(t,e){return e-t}}),jQuery.extend(jQuery.fn.dataTableExt.oSort,{"volume-pre":function(t){return"?"==t?0:(t=parseFloat("-"===t?0:t.replace(/[^\d\-\.]/g,"")),(t=parseFloat(t))||(t=0),t)},"volume-asc":function(t,e){return t-e},"volume-desc":function(t,e){return e-t}}),jQuery.extend(jQuery.fn.dataTableExt.oSort,{"percent-pre":function(t){return(t=parseFloat(t.replace(/[^\d\-\.]/g,"")))||(t=-99999),t},"percent-asc":function(t,e){return t-e},"percent-desc":function(t,e){return e-t}}),marketTypeBtn=$("#usdtBtn"),initMarketlist(),editCustom(),customMark(),$("#marketlist_controller").find("button").click(function(){$(this).addClass("btn_selected").siblings().removeClass("btn_selected"),$(this).siblings().find(".load8").hide(),$(this).find(".load8").show(),$(".hide-show-mark").prop("checked",!1),$(".hide-show-con").unbind("clcik"),editCustom();var t=$(this).attr("value");if($.cookie("market_title",t,{expires:365,path:"/"}),"custom"===t){var e=$.cookie("custom");$(".normal-trade-area").css("display","none"),$(".custom-trade-area").css("display","block"),void 0!==e&&""!=e?ajaxLoadCustom("",2,!1):($(".custom-trade-area").find(".custom-ctrl").hide(),void 0===$(".lead-to-add").attr("class")&&($(".fail-tip").html("No custom coins!").after("<div class='lead-to-add'><button class='r-btn add-btn'>Add</button></div>"),$(".add-btn").click(function(){marketTypeBtn.addClass("from-add").click(),$("#normal_tbody").find(".user-select").show()})),hideLoading())}else"USDT"!=t&&marketTypeBtn.removeClass("from-add"),$(".normal-trade-area").css("display","block"),$(".custom-trade-area").css("display","none"),$("#customBtn").removeClass("dt-mark active-mark"),ajaxLoadMarketlist(t),$(".fail-tip").html(""),$(".lead-to-add").remove();return!1}),window.downloadFile=function(t){if(/(iP)/g.test(navigator.userAgent))return alert("Your device does not support files downloading. Please try again in desktop browser."),!1;if(window.downloadFile.isChrome||window.downloadFile.isSafari){var e=document.createElement("a");if(e.href=t,void 0!==e.download){var a=t.substring(t.lastIndexOf("/")+1,t.length);e.download=a}if(document.createEvent){var o=document.createEvent("MouseEvents");return o.initEvent("click",!0,!0),e.dispatchEvent(o),!0}}return-1===t.indexOf("?")&&(t+="?download"),window.open(t,"_self"),!0},window.downloadFile.isChrome=navigator.userAgent.toLowerCase().indexOf("chrome")>-1,window.downloadFile.isSafari=navigator.userAgent.toLowerCase().indexOf("safari")>-1,$(".gate-logo").click(function(){$("<div class='img-modal logo-img'><img src=/images/gate.io_logo_en.png><span class=img-close>×</span><ul class=save-btn><li onclick=downloadFile('/images/gate.io_logo_en.png')>Save as <b>png</b></li><li onclick=downloadFile('/images/gateio_en.svg')>Save as <b>svg</b></li></ul></div>").prependTo("body");var t=$(".img-modal");fixedAlertPosition(t),$(window).on("resize",function(){fixedAlertPosition(t)}),$(".img-close").click(function(){$(".img-modal").remove(),$(window).off("resize")});var e=setTimeout(function(){$(".img-close").stop().animate({opacity:"0"})},1e3);t.hover(function(){$(".img-close").stop().animate({opacity:"1"}),clearTimeout(e)},function(){$(".img-close").stop().animate({opacity:"0"})})});